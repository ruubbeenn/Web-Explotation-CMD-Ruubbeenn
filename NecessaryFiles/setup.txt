import os
import time
from tqdm import tqdm
import requests
from colorama import init, Fore, Style
import sys

## IMPORTANT
init(autoreset=True)

## PATHS
DataInfoFolder = r"./DataInfo"
setup = r"./DataInfo/setup.txt"
webpaths = r"./DataInfo/WebPaths/"
status = r"./DataInfo/status.txt"

## FUNCTIONS
# ghost
def ghost():
    print("""\n

  .-')      ('-.   .-') _                 _ (`-.  
 ( OO ).  _(  OO) (  OO) )               ( (OO  ) 
(_)---\_)(,------./     '._ ,--. ,--.   _.`     \ 
/    _ |  |  .---'|'--...__)|  | |  |  (__...--'' 
\  :` `.  |  |    '--.  .--'|  | | .-') |  /  | | 
 '..`''.)(|  '--.    |  |   |  |_|( OO )|  |_.' | 
.-._)   \ |  .--'    |  |   |  | | `-' /|  .___.' 
\       / |  `---.   |  |  ('  '-'(_.-' |  |      
 `-----'  `------'   `--'    `-----'    `--'      """)
    
## START
def startup():
    ## INICIO
    os.system("clear")
    print(Fore.CYAN + f"Starting. . .\n")
    ghost()
    os.system("clear")
    ghost()
    print("\n\n")
    

# status.txt
def status_file():
    print(Fore.LIGHTRED_EX + "status.txt doesn't exist.")
    
    try:
        with open(status, "w") as f:
            f.write("Not status")
        
        print(Fore.MAGENTA + "status.txt Folder created!\n")
        time.sleep(0.2)
    
    except Exception as err:
        os.system("clear")
        print(Fore.LIGHTRED_EX + f"An critical internal error has ocurred: {err}")
        print("\nExiting. . .")
        sys.exit()
    
    except KeyboardInterrupt as err:
        playerinput = input("Do you want to cancel the download? (y/n): ")
        
        if playerinput.lower() == "y" or playerinput.lower() == "yes":
            print(f"Download canceled")
        
        else:
            os.system("cls")
            createfile_datainfo()
    
    

# data info
def createfile_datainfo():
    print(Fore.CYAN + "Creating datainfo folder. . .")
    
    try:
        os.mkdir(DataInfoFolder)
        
        print(Fore.MAGENTA + "Datainfo Folder created!\n")
        time.sleep(0.2)
    
    except Exception as err:
        os.system("clear")
        print(Fore.LIGHTRED_EX + f"An critical internal error has ocurred: {err}")
        print("\nExiting. . .")
        sys.exit()
    
    except KeyboardInterrupt as err:
        playerinput = input("Do you want to cancel the download? (y/n): ")
        
        if playerinput.lower() == "y" or playerinput.lower() == "yes":
            print(f"Download canceled")
        
        else:
            os.system("cls")
            createfile_datainfo()
            
# data setup.txt       
def createfile_setup():
    try:
        with open(setup, "w") as f:
            f.write("yes")
    
    except Exception as err:
        os.system("clear")
        print(Fore.LIGHTRED_EX + f"An critical internal error has ocurred: {err}")
        print("\nExiting. . .")
        sys.exit()
    
    except KeyboardInterrupt as err:
        playerinput = input("Do you want to cancel the download? (y/n): ")
        
        if playerinput.lower() == "y" or playerinput.lower() == "yes":
            print(f"Download canceled")
        
        else:
            os.system("cls")
            createfile_setup()
        
def create_webpathsfolder():
    print(Fore.CYAN + "Creating webpaths folder. . .")
    
    try:
        os.mkdir(webpaths)
        
        print(Fore.MAGENTA + "webpaths Folder created!\n")
        time.sleep(0.2)
    
    except Exception as err:
        os.system("clear")
        print(Fore.LIGHTRED_EX + f"An critical internal error has ocurred: {err}")
        print("\nExiting. . .")
        sys.exit()
    
    except KeyboardInterrupt as err:
        playerinput = input("Do you want to cancel the download? (y/n): ")
        
        if playerinput.lower() == "y" or playerinput.lower() == "yes":
            print(f"Download canceled")
        
        else:
            os.system("cls")
            createfile_datainfo()
            
            
def CreateFilesTXT():
        
    try:
        # downloads
        for i in tqdm(range(1), desc=f"ðŸš€ Downloading File"):
            os.system(comando)
        time.sleep(0.25)
        print("\n" + Fore.CYAN + f"{namearchivo}.txt Downloaded succesfully!")
        print("=" * 50 + "\n\n")

    # excepts ERROR CRITICO    
    except Exception as err:
        os.system("clear")
        print(Fore.LIGHTRED_EX + f"An critical internal error has ocurred: {err}")
        print("\nExiting. . .")
        sys.exit()

    # excepts Keyboard interrupt
    except KeyboardInterrupt as err:
        playerinput = input("Do you want to cancel the download? (y/n): ")
        
        if playerinput.lower() == "y" or playerinput.lower() == "yes":
            print(f"Download canceled")

## START
startup()


## CHECK datainfo folder
if not os.path.exists(DataInfoFolder):
    createfile_datainfo()
    
## CREATE .TXT
if not os.path.exists(setup):
    # create it and write "yes" inside
    createfile_setup()

else:
    with open(setup, "r") as f:
        line = f.read()
        
        if not "yes" in line:
            # modify .txt and write "yes"
            createfile_setup()
            

## CHECK webpaths folder
if not os.path.exists(webpaths):
    create_webpathsfolder()
    
if not os.path.exists(status):
    status_file()
    

# VARIABLES
links = {
    "common_paths": {
        "url": "https://raw.githubusercontent.com/ruubbeenn/Web-Explotation-CMD-Ruubbeenn/refs/heads/main/NecessaryFiles/Common_Paths.txt"
    },

    "medium_common_paths": {
        "url": "https://raw.githubusercontent.com/ruubbeenn/Web-Explotation-CMD-Ruubbeenn/refs/heads/main/NecessaryFiles/Medium-Common_Paths.txt"
    },

    "large_common_paths": {
        "url": "https://raw.githubusercontent.com/ruubbeenn/Web-Explotation-CMD-Ruubbeenn/refs/heads/main/NecessaryFiles/Large-Common_Paths.txt"
    } ,

    "all_paths": {
        "url": "https://raw.githubusercontent.com/ruubbeenn/Web-Explotation-CMD-Ruubbeenn/refs/heads/main/NecessaryFiles/All_Paths.txt"
    }
}

## GET FILES
for i in links:
    for clave, valor in links[i].items():
        pathdef = webpaths + i + ".txt"
        comando = f"wget -q -O{pathdef} {valor}"
        namearchivo = i
        
        print("\n" + "=" * 50)
        print(Fore.GREEN + f"DOWNLOADING {i}.txt\n")
        CreateFilesTXT()
        
print(Fore.YELLOW + f"\nAll files downloaded succesfully!")
print(input(Fore.GREEN + f"Press any button to continue with the program."))
os.system("clear")
